java:
  applicationPort: 4550
  image: 'sdshmctspublic.azurecr.io/darts/api:latest'
  ingressHost: darts-api.{{ .Values.global.environment }}.platform.hmcts.net
  aadIdentityName: darts
  keyVaults:
    darts:
      secrets:
        - name: GovukNotifyApiKey
          alias: GOVUK_NOTIFY_API_KEY
        - name: darts-api-POSTGRES-USER
          alias: DARTS_API_DB_USERNAME
        - name: darts-api-POSTGRES-PASS
          alias: DARTS_API_DB_PASSWORD
        - name: darts-api-POSTGRES-HOST
          alias: DARTS_API_DB_HOST
        - name: AppInsightsInstrumentationKey
          alias: APP_INSIGHTS_KEY
        - name: AzureAdB2CTenantIdKey
          alias: AAD-B2C-TENANT_ID_KEY
        - name: AzureAdB2CClientIdKey
          alias: AAD-B2C-CLIENT_ID_KEY
        - name: AzureAdB2CClientSecretKey
          alias: AAD-B2C-CLIENT_SECRET_KEY
  environment:
    DARTS_API_DB_NAME: "darts"
    NOTIFICATION_SCHEDULER_CRON: "* */2 * * * MON-FRI"
    POSTGRES_SSL_MODE: require
function:
  releaseNameOverride: darts-api-audio
  scaleType: Object
  object: 
    apiVersion: apps/v1
    kind: Deployment
    name: darts-api
    pollingInterval: 30
    cooldownPeriod: 90
    idleReplicaCount: 1
    maxReplicaCount: 1
    minReplicaCount: 1
  triggerAuth:
    create: true
    enabled: true
    triggerPodIdentityProvider: azure
  triggers:
    - type: postgresql
      metadata:
        userName: "{{ .Values.postgresql.auth.username}}"
        password: "{{ .Values.postgresql.auth.password}}"
        host: "{{ .Release.Name }}-postgresql"
        port: "5432"
        dbName: "{{ .Values.postgresql.auth.database}}"
        sslmode: disable
        query: "SELECT 5 as desired_pods"