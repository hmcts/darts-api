# Don't modify this file, it is only needed for the pipeline to set the image and ingressHost
java:
  image: ${IMAGE_NAME}
  ingressHost: ${SERVICE_FQDN}
  environment:
    ENABLE_FLYWAY: true
    RUN_DB_MIGRATION_ON_STARTUP: true
    DB_HOST: "{{ .Release.Name }}-postgresql"
    DB_NAME: "{{ .Values.postgresql.auth.database}}"
    DB_USER: "{{ .Values.postgresql.auth.username}}"
    DB_PASS: "{{ .Values.postgresql.auth.password}}"
    DB_PORT: 5432
    DB_OPTIONS: '?sslmode=allow'
    #AZURE_APPLICATIONINSIGHTS_INSTRUMENTATIONKEY: '3c3bacb7-64e0-476c-aeaa-657657b063fd'
  #disableKeyVaults: true
  postgresql:
    enabled: true
    image:
      registry: hmctspublic.azurecr.io
      repository: imported/bitnami/postgresql
      tag: '11.6.0'
    primary:
      persistence:
        enabled: false
      resources:
        requests:
          cpu: 25m
      initdb:
        scripts:
          init.sql: |-
            CREATE DATABASE darts WITH OWNER = hmcts ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
    auth:
      username: darts
      password: darts
  devApplicationInsightsInstrumentKeyName: AZURE_APPLICATIONINSIGHTS_INSTRUMENTATIONKEY

